<!DOCTYPE html>
<html>
  <head>
    <title>Chat Test</title>
    <style>
      body {
        font-family: Arial, sans-serif;
      }
      #messages {
        list-style-type: none;
        margin: 0;
        padding: 0;
        border: 1px solid #ccc;
        height: 300px;
        overflow-y: scroll;
      }
      #messages li {
        padding: 5px 10px;
      }
      #form {
        display: flex;
      }
      #input {
        border: 1px solid #ccc;
        padding: 10px;
        flex-grow: 1;
      }
      #form button {
        background: #007bff;
        border: none;
        padding: 10px;
        color: white;
      }
    </style>
  </head>
  <body>
    <h1>My Chat App Test</h1>
    <ul id="messages"></ul>
    <form id="form" action="">
      <input
        id="input"
        autocomplete="off"
        placeholder="Type a message..."
      /><button>Send</button>
    </form>

    <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
    <script>
      // ---- CONFIGURATION ----
      // In Tab 1, use these IDs. In Tab 2, swap them.
      const MY_ID = "68e027f705444dc777e3d3f8";
      const RECEIVER_ID = "68bfb3d0f209b43946160975";
      // -----------------------

      const socket = io("http://localhost:4000");
      const messages = document.getElementById("messages");
      const form = document.getElementById("form");
      const input = document.getElementById("input");

      // Send a message
      form.addEventListener("submit", function (e) {
        e.preventDefault();
        if (input.value) {
          const msg = {
            senderId: MY_ID,
            receiverId: RECEIVER_ID,
            type: "text",
            content: input.value,
          };
          socket.emit("sendMessage", msg);

          // Display your own message
          const item = document.createElement("li");
          item.textContent = "Me: " + input.value;
          item.style.textAlign = "right";
          messages.appendChild(item);
          window.scrollTo(0, document.body.scrollHeight);
          input.value = "";
        }
      });

      // Listen for incoming messages
      socket.on("receiveMessage", function (msg) {
        const item = document.createElement("li");
        item.textContent = "Them: " + msg.message.content; // Based on your socket code
        messages.appendChild(item);
        window.scrollTo(0, document.body.scrollHeight);
      });
    </script>
  </body>
</html>
